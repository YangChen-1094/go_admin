(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cdn"],{"0574":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-col",{attrs:{span:20}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),t._v(" CDN文件列表 ")])],1)],1)])])],1),a("div",{staticClass:"container"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"目标主机"}},[a("div",[t._v(t._s(t.rootUrl))])]),a("el-form-item",{attrs:{label:"文件"}},[a("el-col",{attrs:{span:5}},[a("input",{attrs:{type:"file"},on:{change:t.handleFileChange}})])],1),a("el-form-item",{attrs:{label:"是否加密"}},[a("el-checkbox",{model:{value:t.encrypt,callback:function(e){t.encrypt=e},expression:"encrypt"}},[t._v("加密")])],1),a("el-form-item",{attrs:{label:"操作"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.goUpload}},[t._v("确认上传")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.mkDir}},[t._v("创建目录")]),a("el-button",{attrs:{type:"warning"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("创建索引")])],1)],1)],1),a("div",{staticClass:"container"},[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.table_data,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"id",label:"名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"filename",on:{click:function(a){return t.goPath(e.row.path)}}},[t._v(t._s(e.row.filename))])]}}])}),a("el-table-column",{attrs:{label:"url",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"url",attrs:{href:e.row.url}},[t._v(t._s(e.row.url))])]}}])}),a("el-table-column",{attrs:{label:"类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.format_size?[t._v(t._s(e.row.type))]:void 0}}],null,!0)}),a("el-table-column",{attrs:{label:"大小",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.format_size))]}}])}),a("el-table-column",{attrs:{label:"最后修改时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.update_time))]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.decryptXML?a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.handleDecryptXML(e.$index,e.row)}}},[t._v("解谜")]):t._e()]}}])})],1)],1),a("el-dialog",{attrs:{title:"",top:"5vh",visible:t.dirDialogVisible,width:"30%"},on:{"update:visible":function(e){t.dirDialogVisible=e}}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[t._v("目录名称")])]),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{placeholder:"请输入目录名称"},model:{value:t.newDir,callback:function(e){t.newDir=e},expression:"newDir"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dirDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.mkDirConfirm}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("span",[t._v("确定要创建索引吗？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.mkIndexConfirm}},[t._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"解谜",visible:t.decryptDialogVisible,width:"60%"},on:{"update:visible":function(e){t.decryptDialogVisible=e}}},[a("el-input",{attrs:{type:"textarea",rows:"10",cols:"20"},model:{value:t.decryptContent,callback:function(e){t.decryptContent=e},expression:"decryptContent"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.decryptDialogVisible=!1}}},[t._v("关 闭")])],1)],1)],1)},n=[],l=a("ade3"),o=(a("ac6a"),a("b775")),r=a("c1df"),s=a("bc3a"),c={name:"noticeList",data:function(){return{table_data:[],path:"",rootUrl:"",newDir:"",decryptContent:"",encrypt:!1,dialogVisible:!1,dirDialogVisible:!1,decryptDialogVisible:!1,decryptXML:!1,form:{},formData:{}}},created:function(){this.formData=new FormData,this.getData()},methods:{getData:function(){var t=this;o["a"].post("./cdnList",{path:this.path}).then((function(e){e.data.items.forEach((function(t,a){t.update_time?e.data.items[a]["update_time"]=r(1e3*t.update_time).format("YYYY-MM-DD HH:mm:ss"):e.data.items[a]["update_time"]="",e.data.items[a]["decryptXML"]=t.url.indexOf(".xml")>-1})),t.rootUrl=e.data.rootUrl,t.table_data=e.data.items,t.path=e.data.path}))},goPath:function(t){this.path=t,this.getData()},mkDir:function(){this.dirDialogVisible=!0},mkDirConfirm:function(){var t=this,e=this;o["a"].post("./cdnMkdir",{path:this.path,name:this.newDir}).then((function(a){200==a.code?t.$message({message:"创建成功",type:"success",onClose:function(){e.dirDialogVisible=!1,e.getData()}}):t.$message.error(a.msg)}))},mkIndexConfirm:function(){var t=this,e=this;o["a"].post("./cdnMkIndex",{path:this.path}).then((function(a){200==a.code?(e.dialogVisible=!1,t.$message({message:"创建索引成功",type:"success"})):t.$message.error(a.msg)}))},handleFileChange:function(t){this.formData.append("userfile",t.target.files[0])},goUpload:function(){var t=this.encrypt?"1":"0",e=this;s({method:"post",url:o["a"].serverBaseUrl+"/webadmins/cdnUpload?encrypt="+t+"&path="+this.path,headers:Object(l["a"])({"Content-Type":"application/x-www-form-urlencoded"},"Content-Type","multipart/form-data"),data:e.formData}).then((function(t){200==t.data.code?e.$message({message:"上传成功",type:"success",onClose:function(){e.getData()}}):e.$message.error(t.data.msg)}))},handleDecryptXML:function(t,e){var a=this,i=this;o["a"].post("./cdnShow",{url:e.url}).then((function(t){200==t.code?(i.decryptContent=t.data.content,i.decryptDialogVisible=!0):a.$message.error("解谜失败")}))}}},d=c,u=(a("8a62"),a("2877")),p=Object(u["a"])(d,i,n,!1,null,"311e79b8",null);e["default"]=p.exports},"5b44":function(t,e,a){},"8a62":function(t,e,a){"use strict";a("5b44")},ade3:function(t,e,a){"use strict";function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",(function(){return i}))}}]);